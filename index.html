<!DOCTYPE html>
<html lang="en" manifest="/public/chromecast.manifest">
<head>
    <meta charset="utf-8">
    <title>Receiver</title>
    <style>
      #message {
        background-color: white;
        font-size: 100px;
      }
    </style>
</head>
<body>
  Ejemplo de receptor
  <script src="//www.gstatic.com/cast/sdk/libs/caf_receiver/v3/cast_receiver_framework.js"></script>
  <!--<cast-media-player></cast-media-player>-->
  <div id="message"></div>

  <script>
    var context = cast.framework.CastReceiverContext.getInstance();
    context.addEventListener(cast.framework.system.EventType.READY, function(event) {
      console.log('READY', event);
    });

    context.addEventListener(cast.framework.system.EventType.SHUTDOWN, function(event) {
      console.log('SHUTDOWN', event);
    });

    context.addEventListener(cast.framework.system.EventType.SENDER_CONNECTED, function(event) {
      console.log('SENDER_CONNECTED', event);

      console.log('application data', context.getApplicationData());
      console.log('device capabilities', context.getDeviceCapabilities());
      console.log('get senders', context.getSenders());
      console.log('get system state', context.getSystemState());
      console.log('get visibility state', context.getVisibilityState());
    });

    context.addEventListener(cast.framework.system.EventType.SENDER_DISCONNECTED, function(event) {
      console.log('SENDER_DISCONNECTED', event);
    });

    context.addEventListener(cast.framework.system.EventType.ERROR, function(event) {
      console.log('ERROR', event);
    });

    context.addEventListener(cast.framework.system.EventType.SYSTEM_VOLUME_CHANGED, function(event) {
      console.log('SYSTEM_VOLUME_CHANGED', event);
    });

    context.addEventListener(cast.framework.system.EventType.VISIBILITY_CHANGED, function(event) {
      console.log('VISIBILITY_CHANGED', event);
    });

    context.addEventListener(cast.framework.system.EventType.STANDBY_CHANGED, function(event) {
      console.log('STANDBY_CHANGED', event);
    });

    context.addEventListener(cast.framework.system.EventType.MAX_VIDEO_RESOLUTION_CHANGED, function(event) {
      console.log('MAX_VIDEO_RESOLUTION_CHANGED', event);
    });

    context.addEventListener(cast.framework.system.EventType.FEEDBACK_STARTED, function(event) {
      console.log('FEEDBACK_STARTED', event);
    });

    context.addCustomMessageListener('urn:x-cast:com.example.test', function(event) {
      console.log('message', event);
      document.getElementById('message').innerText = event.data.message;
    });

    const playerManager = context.getPlayerManager();

	/*
    playerManager.addEventListener(cast.framework.events.category.CAN_PLAY_THROUGH, function() {
            playerManager.play();
    });
    */

    context.start();

/*
    console.log('cast', cast);
    console.log('cast.receiver', cast.receiver);
    console.log('cast.receiver.CastReceiverManager', cast.receiver.CastReceiverManager);
    console.log('cast.receiver.CastReceiverManager.getInstance()', cast.receiver.CastReceiverManager.getInstance());

    var castReceiverManager = cast.receiver.CastReceiverManager.getInstance();
    castReceiverManager.onReady = function(event) {
      console.log('castReceiverManager.onReady', event);
    }

    castReceiverManager.onSenderConnected = function(event) {
      console.log('castReceiverManager.onSenderConnected', event);
    }

    castReceiverManager.onSenderDisconnected = function(event) {
      console.log('castReceiverManager.onSenderDisconnected', event);
    }

    var messageBus = castReceiverManager.getCastMessageBus('urn:x-cast:ar.com.bondus');
    messageBus.onMessage = function(event) {
      console.log('messageBus.onMessage', event);
    }

    castReceiverManager.start();
*/
    //cast.framework.CastReceiverContext.getInstance().start();
  </script>
</body>
</html>
